# ç‰¹å¾ç»´åº¦ä¸åŒ¹é…é—®é¢˜è¯¦è§£

## é—®é¢˜æ¦‚è¿°

EVolsplatTrainer ä¸­å­˜åœ¨ä¸¤ä¸ªç›¸å…³çš„ç‰¹å¾ç»´åº¦ä¸åŒ¹é…é—®é¢˜ï¼Œéƒ½æºäº**åˆå§‹åŒ–æ—¶çš„é…ç½®å‡è®¾**ä¸**è¿è¡Œæ—¶å®é™…æ•°æ®ç»´åº¦**ä¸ä¸€è‡´ã€‚

---

## é—®é¢˜ 2ï¼šç‰¹å¾ç»´åº¦ä¸åŒ¹é…é—®é¢˜

### é—®é¢˜æœ¬è´¨

ä»£ç åœ¨åˆå§‹åŒ–æ—¶åŸºäºé…ç½®å‚æ•°è®¡ç®—ç‰¹å¾ç»´åº¦ï¼Œä½†è¿è¡Œæ—¶ `sample_within_window` è¿”å›çš„å®é™…ç»´åº¦å¯èƒ½ä¸å‡è®¾ä¸ç¬¦ã€‚

### ç»´åº¦è®¡ç®—æµç¨‹

```
åˆå§‹åŒ–é˜¶æ®µï¼ˆ_init_networksï¼‰
â”œâ”€ è¯»å–é…ç½®
â”‚  â”œâ”€ num_neighbour_select = 4 (é»˜è®¤)
â”‚  â””â”€ local_radius = 1 (é»˜è®¤)
â”‚
â”œâ”€ è®¡ç®—ç‰¹å¾ç»´åº¦
â”‚  â””â”€ feature_dim_in = 4 * num_neighbours * (2*local_radius+1)^2
â”‚     = 4 * 4 * (2*1+1)^2
â”‚     = 4 * 4 * 9
â”‚     = 144
â”‚
â””â”€ æ„å»º MLP
   â””â”€ gaussion_decoder: in_dim = feature_dim_in + 4 = 148

è¿è¡Œæ—¶é˜¶æ®µï¼ˆextract_shared_featuresï¼‰
â”œâ”€ è°ƒç”¨ sample_within_window
â”‚  â””â”€ è¿”å›: [N, num_views, (2R+1)^2, 3] å’Œ [N, num_views, (2R+1)^2, 1]
â”‚
â”œâ”€ å®é™…è§†å›¾æ•°é‡
â”‚  â””â”€ num_views = 9 (å®é™…æºè§†å›¾æ•°é‡ï¼Œä¸æ˜¯é…ç½®çš„4)
â”‚
â”œâ”€ è®¡ç®—å®é™…ç‰¹å¾ç»´åº¦
â”‚  â””â”€ actual_feature_dim_in = 4 * 9 * 9 = 324
â”‚
â””â”€ ç»´åº¦ä¸åŒ¹é…ï¼
   â”œâ”€ æœŸæœ›: 144 (åŸºäº num_neighbour_select=4)
   â””â”€ å®é™…: 324 (åŸºäºå®é™…è§†å›¾æ•°=9)
```

### æ•°æ®æµå¯¹æ¯”è¡¨

| é˜¶æ®µ | é…ç½®å‚æ•° | è®¡ç®—çš„ç»´åº¦ | å®é™…ç»´åº¦ | æ˜¯å¦åŒ¹é… |
|------|---------|-----------|---------|---------|
| **åˆå§‹åŒ–** | `num_neighbour_select=4`<br>`local_radius=1` | `feature_dim_in = 4 * 4 * 9 = 144` | - | - |
| **è¿è¡Œæ—¶** | - | `actual_feature_dim_in = 4 * 9 * 9 = 324` | `[N, 9, 9, 4]` â†’ `[N, 324]` | âŒ **ä¸åŒ¹é…** |

### ä»£ç æ‰§è¡Œæµç¨‹

```python
# ========== åˆå§‹åŒ–é˜¶æ®µ ==========
# models/trainers/evolsplat.py:150-153
self.num_neighbours = model_cfg.num_neighbour_select  # 4
self.feature_dim_in = 4 * self.num_neighbours * (2 * self.local_radius + 1) ** 2
# feature_dim_in = 4 * 4 * 9 = 144

# models/trainers/evolsplat.py:157-165
self.gaussion_decoder = MLP(
    in_dim=self.feature_dim_in + 4,  # 144 + 4 = 148
    ...
)

# ========== è¿è¡Œæ—¶é˜¶æ®µ ==========
# models/trainers/evolsplat.py:540-547
sampled_feat, valid_mask, vis_map = self.projector.sample_within_window(...)
# sampled_feat: [N, 9, 9, 3]  (å‡è®¾æœ‰9ä¸ªè§†å›¾)
# vis_map: [N, 9, 9, 1]

# models/trainers/evolsplat.py:559-564
num_views = sampled_feat.shape[1]  # 9 (å®é™…è§†å›¾æ•°)
window_size = sampled_feat.shape[2]  # 9
actual_feature_dim_in = 4 * num_views * window_size  # 4 * 9 * 9 = 324

# models/trainers/evolsplat.py:567-577
if actual_feature_dim_in != self.feature_dim_in:  # 324 != 144
    logger.warning("Feature dimension mismatch...")
    self.feature_dim_in = actual_feature_dim_in  # âŒ åªæ›´æ–°å±æ€§ï¼Œä¸é‡å»ºMLP

# models/trainers/evolsplat.py:580-584
sampled_feat = torch.concat([sampled_feat, vis_map], dim=-1)  # [N, 9, 9, 4]
sampled_feat = sampled_feat.reshape(num_points, self.feature_dim_in)  # [N, 324]
# âŒ ä½† self.feature_dim_in ç°åœ¨æ˜¯ 324ï¼Œè€Œ MLP æœŸæœ› 144

# models/trainers/evolsplat.py:669-670
input_feature = torch.cat([sampled_color, ob_dist, ob_view], dim=-1)
# input_feature: [N, 324 + 4] = [N, 328]
sh = self.gaussion_decoder(input_feature)  # âŒ RuntimeError: æœŸæœ› [N, 148]ï¼Œå¾—åˆ° [N, 328]
```

### é—®é¢˜æ ¹æºåˆ†æ

| é—®é¢˜ç‚¹ | è¯´æ˜ | å½±å“ |
|--------|------|------|
| **é…ç½®å‡è®¾** | `num_neighbour_select` å‡è®¾åªä½¿ç”¨4ä¸ªè§†å›¾ | åˆå§‹åŒ–æ—¶åŸºäºæ­¤å‡è®¾æ„å»ºMLP |
| **å®é™…è¡Œä¸º** | `sample_within_window` è¿”å›**æ‰€æœ‰**æºè§†å›¾çš„ç‰¹å¾ | å®é™…å¯èƒ½æœ‰9ä¸ªæˆ–æ›´å¤šè§†å›¾ |
| **ç»´åº¦æ›´æ–°** | è¿è¡Œæ—¶åªæ›´æ–° `self.feature_dim_in` å±æ€§ | âŒ **ä¸é‡å»ºMLP**ï¼ŒMLPè¾“å…¥ç»´åº¦ä»ç„¶æ˜¯148 |
| **å‰å‘ä¼ æ’­** | å°è¯•ç”¨328ç»´è¾“å…¥è°ƒç”¨æœŸæœ›148ç»´çš„MLP | âŒ **å¿…ç„¶å¤±è´¥** |

---

## é—®é¢˜ 2.1ï¼šMLP ç»´åº¦ä¸åŒ¹é…é—®é¢˜ï¼ˆé—®é¢˜2çš„å»¶ä¼¸ï¼‰

### é—®é¢˜æœ¬è´¨

è¿™æ˜¯é—®é¢˜2çš„ç›´æ¥åæœï¼šå³ä½¿æ›´æ–°äº† `feature_dim_in` å±æ€§ï¼ŒMLP çš„è¾“å…¥ç»´åº¦ä»ç„¶æ˜¯åˆå§‹åŒ–æ—¶çš„å€¼ï¼Œå¯¼è‡´å‰å‘ä¼ æ’­å¤±è´¥ã€‚

### ç»´åº¦ä¸åŒ¹é…ç¤ºæ„å›¾

```
åˆå§‹åŒ–æ—¶çš„ MLP ç»“æ„
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ gaussion_decoder                     â”‚
â”‚   Input:  [N, 148]                  â”‚  â† åŸºäº num_neighbour_select=4
â”‚   Layer 1: 148 â†’ 128                â”‚
â”‚   Layer 2: 128 â†’ 128                â”‚
â”‚   Layer 3: 128 â†’ feature_dim_out    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è¿è¡Œæ—¶å®é™…è¾“å…¥
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ input_feature                       â”‚
â”‚   Shape: [N, 328]                   â”‚  â† åŸºäºå®é™…è§†å›¾æ•°=9
â”‚   = sampled_color [N, 324]          â”‚
â”‚     + ob_dist [N, 1]                â”‚
â”‚     + ob_view [N, 3]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    âŒ ç»´åº¦ä¸åŒ¹é…ï¼
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RuntimeError                        â”‚
â”‚ Expected input size 148,            â”‚
â”‚ but got input size 328              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è¯¦ç»†ç»´åº¦è¿½è¸ªè¡¨

| æ­¥éª¤ | å˜é‡/æ“ä½œ | ç»´åº¦ | è¯´æ˜ |
|------|----------|------|------|
| **1. åˆå§‹åŒ–** | `self.num_neighbours` | `4` | ä»é…ç½®è¯»å– |
| | `self.feature_dim_in` | `144` | `4 * 4 * 9` |
| | `gaussion_decoder.in_dim` | `148` | `144 + 4` (ob_dist + ob_view) |
| **2. sample_within_window** | `sampled_feat` | `[N, 9, 9, 3]` | 9ä¸ªè§†å›¾ï¼Œçª—å£3x3 |
| | `vis_map` | `[N, 9, 9, 1]` | å¯è§æ€§å›¾ |
| **3. æ‹¼æ¥** | `torch.concat([sampled_feat, vis_map], dim=-1)` | `[N, 9, 9, 4]` | RGB(3) + visibility(1) |
| **4. é‡å¡‘** | `reshape(N, feature_dim_in)` | `[N, 324]` | `9 * 9 * 4 = 324` |
| **5. è£å‰ª** | `sampled_color[projection_mask]` | `[num_valid, 324]` | è¿‡æ»¤æœ‰æ•ˆç‚¹ |
| **6. æ‹¼æ¥è§‚å¯Ÿä¿¡æ¯** | `torch.cat([sampled_color, ob_dist, ob_view])` | `[num_valid, 328]` | `324 + 1 + 3` |
| **7. MLPå‰å‘ä¼ æ’­** | `gaussion_decoder(input_feature)` | âŒ **å¤±è´¥** | æœŸæœ›148ï¼Œå¾—åˆ°328 |

### é”™è¯¯å‘ç”Ÿæ—¶æœº

```
è®­ç»ƒæ­¥éª¤å¼€å§‹
    â†“
extract_shared_features()
    â”œâ”€ sample_within_window() â†’ [N, 9, 9, 3], [N, 9, 9, 1]
    â”œâ”€ concat â†’ [N, 9, 9, 4]
    â”œâ”€ reshape â†’ [N, 324]
    â””â”€ æ›´æ–° self.feature_dim_in = 324 (ä½†MLPä¸å˜)
    â†“
render_for_target_view()
    â”œâ”€ è£å‰ªåˆ°æœ‰æ•ˆç‚¹ â†’ sampled_color: [num_valid, 324]
    â”œâ”€ æ‹¼æ¥è§‚å¯Ÿä¿¡æ¯ â†’ input_feature: [num_valid, 328]
    â””â”€ gaussion_decoder(input_feature)
        â†“
    âŒ RuntimeError: 
       mat1 and mat2 shapes cannot be multiplied (num_valid x 328 and 148 x 128)
```

---

## é—®é¢˜æ ¹æºæ€»ç»“

### æ ¸å¿ƒçŸ›ç›¾

| æ–¹é¢ | é…ç½®å‡è®¾ | å®é™…è¡Œä¸º | å†²çª |
|------|---------|---------|------|
| **è§†å›¾æ•°é‡** | `num_neighbour_select = 4` | å®é™…æºè§†å›¾ = 9 | ä¸ä¸€è‡´ |
| **ç‰¹å¾ç»´åº¦** | `feature_dim_in = 144` | å®é™…ç‰¹å¾ç»´åº¦ = 324 | ä¸ä¸€è‡´ |
| **MLPè¾“å…¥** | `in_dim = 148` | å®é™…è¾“å…¥ = 328 | âŒ **å´©æºƒ** |

### è®¾è®¡æ„å›¾ vs å®é™…å®ç°

```
è®¾è®¡æ„å›¾ï¼ˆEVolsplatåŸå§‹è®¾è®¡ï¼‰
â”œâ”€ num_neighbour_select ç”¨äºé™åˆ¶ä½¿ç”¨çš„è§†å›¾æ•°é‡
â”œâ”€ åªé€‰æ‹© num_neighbour_select ä¸ªè§†å›¾è¿›è¡Œç‰¹å¾æå–
â””â”€ ç‰¹å¾ç»´åº¦ = 4 * num_neighbour_select * (2R+1)^2

å®é™…å®ç°ï¼ˆå½“å‰ä»£ç ï¼‰
â”œâ”€ sample_within_window è¿”å›æ‰€æœ‰æºè§†å›¾çš„ç‰¹å¾
â”œâ”€ æ²¡æœ‰è§†å›¾é€‰æ‹©/é™åˆ¶é€»è¾‘
â””â”€ ç‰¹å¾ç»´åº¦ = 4 * å®é™…è§†å›¾æ•° * (2R+1)^2
```

---

## è§£å†³æ–¹æ¡ˆå¯¹æ¯”

### æ–¹æ¡ˆ Aï¼šé™åˆ¶è§†å›¾æ•°é‡ï¼ˆæ¨èï¼‰

**æ€è·¯**ï¼šåœ¨ reshape ä¹‹å‰ï¼Œåªé€‰æ‹© `num_neighbour_select` ä¸ªè§†å›¾ã€‚

```
sample_within_window() è¿”å›
â”œâ”€ sampled_feat: [N, 9, 9, 3]  (9ä¸ªè§†å›¾)
â”œâ”€ valid_mask: [N, 9, 9]
â””â”€ vis_map: [N, 9, 9, 1]
    â†“
é™åˆ¶è§†å›¾æ•°é‡ (é€‰æ‹©å‰4ä¸ª)
â”œâ”€ sampled_feat: [N, 4, 9, 3]  (4ä¸ªè§†å›¾)
â”œâ”€ valid_mask: [N, 4, 9]
â””â”€ vis_map: [N, 4, 9, 1]
    â†“
æ‹¼æ¥å’Œé‡å¡‘
â”œâ”€ concat â†’ [N, 4, 9, 4]
â””â”€ reshape â†’ [N, 144]  âœ… åŒ¹é… MLP è¾“å…¥
```

**ä¼˜ç‚¹**ï¼š
- âœ… ç®€å•ç›´æ¥ï¼Œä¸éœ€è¦é‡å»ºMLP
- âœ… ä¸EVolsplatåŸå§‹è®¾è®¡ä¸€è‡´
- âœ… ä¸éœ€è¦ä¿®æ”¹ä¼˜åŒ–å™¨

**ç¼ºç‚¹**ï¼š
- âš ï¸ ä¸¢å¼ƒäº†ä¸€äº›è§†å›¾çš„ä¿¡æ¯

### æ–¹æ¡ˆ Bï¼šåŠ¨æ€é‡å»ºMLP

**æ€è·¯**ï¼šæ£€æµ‹åˆ°ç»´åº¦ä¸åŒ¹é…æ—¶ï¼Œé‡å»º `gaussion_decoder`ã€‚

```
æ£€æµ‹ç»´åº¦ä¸åŒ¹é…
    â†“
ä¿å­˜æ—§MLPçŠ¶æ€ï¼ˆå¯é€‰ï¼‰
    â†“
é‡å»º gaussion_decoder
â”œâ”€ in_dim = actual_feature_dim_in + 4
â””â”€ é‡æ–°åˆå§‹åŒ–æƒé‡
    â†“
æ›´æ–°ä¼˜åŒ–å™¨å‚æ•°
â”œâ”€ ç§»é™¤æ—§å‚æ•°
â””â”€ æ·»åŠ æ–°å‚æ•°
    â†“
ç»§ç»­è®­ç»ƒ
```

**ä¼˜ç‚¹**ï¼š
- âœ… ä½¿ç”¨æ‰€æœ‰è§†å›¾çš„ä¿¡æ¯
- âœ… æ›´çµæ´»

**ç¼ºç‚¹**ï¼š
- âŒ å®ç°å¤æ‚ï¼Œéœ€è¦æ›´æ–°ä¼˜åŒ–å™¨
- âŒ å¯èƒ½å½±å“è®­ç»ƒç¨³å®šæ€§ï¼ˆæƒé‡é‡æ–°åˆå§‹åŒ–ï¼‰
- âŒ éœ€è¦å¤„ç†ä¼˜åŒ–å™¨çŠ¶æ€

### æ–¹æ¡ˆ Cï¼šç¡®ä¿é…ç½®ä¸€è‡´æ€§ï¼ˆæœ€ä½³å®è·µï¼‰

**æ€è·¯**ï¼šåœ¨åˆå§‹åŒ–æ—¶ç¡®ä¿ `num_neighbour_select` ç­‰äºå®é™…çš„æºè§†å›¾æ•°é‡ã€‚

```
åˆå§‹åŒ–é˜¶æ®µ
â”œâ”€ ä» dataset è·å–å®é™…æºè§†å›¾æ•°é‡
â”‚  â””â”€ num_source_views = num_source_keyframes * num_cameras
â”‚
â”œâ”€ æ£€æŸ¥é…ç½®ä¸€è‡´æ€§
â”‚  â””â”€ if num_neighbour_select != num_source_views:
â”‚      â””â”€ æ›´æ–° num_neighbour_select = num_source_views
â”‚
â””â”€ åŸºäºå®é™…è§†å›¾æ•°æ„å»ºMLP
   â””â”€ feature_dim_in = 4 * num_source_views * (2R+1)^2
```

**ä¼˜ç‚¹**ï¼š
- âœ… ä»æ ¹æœ¬ä¸Šè§£å†³é—®é¢˜
- âœ… é…ç½®æ¸…æ™°ï¼Œé¿å…è¿è¡Œæ—¶é”™è¯¯
- âœ… ä¸éœ€è¦è¿è¡Œæ—¶ä¿®å¤

**ç¼ºç‚¹**ï¼š
- âš ï¸ éœ€è¦æ›´æ—©çš„æ£€æŸ¥ï¼ˆåˆå§‹åŒ–æ—¶ï¼‰
- âš ï¸ éœ€è¦ä»datasetè·å–ä¿¡æ¯

---

## æ¨èè§£å†³æ–¹æ¡ˆ

### çŸ­æœŸä¿®å¤ï¼šæ–¹æ¡ˆ Aï¼ˆé™åˆ¶è§†å›¾æ•°é‡ï¼‰

**å®ç°ä½ç½®**ï¼š`models/trainers/evolsplat.py` çš„ `extract_shared_features()` æ–¹æ³•

```python
# åœ¨ reshape ä¹‹å‰æ·»åŠ è§†å›¾é™åˆ¶
sampled_feat, valid_mask, vis_map = self.projector.sample_within_window(...)

# é™åˆ¶è§†å›¾æ•°é‡
num_views = sampled_feat.shape[1]
if num_views > self.num_neighbours:
    sampled_feat = sampled_feat[:, :self.num_neighbours, :, :]
    valid_mask = valid_mask[:, :self.num_neighbours, :]
    vis_map = vis_map[:, :self.num_neighbours, :, :]
    logger.info(f"Limited views from {num_views} to {self.num_neighbours}")

# ç°åœ¨ reshape ä¼šå¾—åˆ°æ­£ç¡®çš„ç»´åº¦
sampled_feat = torch.concat([sampled_feat, vis_map], dim=-1)
sampled_feat = sampled_feat.reshape(sampled_feat.shape[0], self.feature_dim_in)
```

### é•¿æœŸä¼˜åŒ–ï¼šæ–¹æ¡ˆ Cï¼ˆé…ç½®ä¸€è‡´æ€§æ£€æŸ¥ï¼‰

**å®ç°ä½ç½®**ï¼š`models/trainers/evolsplat.py` çš„ `_init_networks()` æ–¹æ³•

```python
# åœ¨æ„å»º gaussion_decoder ä¹‹å‰
# è·å–å®é™…æºè§†å›¾æ•°é‡
num_source_views = (
    self.config.multi_scene.num_source_keyframes *
    len(self.config.data.pixel_source.get("cameras", []))
)

# ç¡®ä¿é…ç½®ä¸€è‡´æ€§
if model_cfg.num_neighbour_select != num_source_views:
    logger.warning(
        f"num_neighbour_select ({model_cfg.num_neighbour_select}) "
        f"doesn't match actual source views ({num_source_views}). "
        f"Updating to match."
    )
    model_cfg.num_neighbour_select = num_source_views
    self.num_neighbours = num_source_views
    self.feature_dim_in = 4 * self.num_neighbours * (2 * self.local_radius + 1) ** 2
```

---

## é—®é¢˜å½±å“è¯„ä¼°

| é—®é¢˜ | ä¸¥é‡æ€§ | è§¦å‘æ¡ä»¶ | å½±å“èŒƒå›´ |
|------|--------|---------|---------|
| **é—®é¢˜2** | ğŸ”´ High | å®é™…è§†å›¾æ•° â‰  `num_neighbour_select` | ç‰¹å¾æå–é˜¶æ®µ |
| **é—®é¢˜2.1** | ğŸ”´ High | åŒä¸Š | å‰å‘ä¼ æ’­é˜¶æ®µï¼Œè®­ç»ƒå´©æºƒ |

### å…¸å‹åœºæ™¯

| é…ç½® | å®é™…è§†å›¾æ•° | æ˜¯å¦è§¦å‘é—®é¢˜ | é”™è¯¯ä¿¡æ¯ |
|------|-----------|------------|---------|
| `num_neighbour_select=4`, å®é™…9ä¸ªè§†å›¾ | 9 | âœ… æ˜¯ | `Expected input size 148, got 328` |
| `num_neighbour_select=4`, å®é™…4ä¸ªè§†å›¾ | 4 | âŒ å¦ | - |
| `num_neighbour_select=9`, å®é™…9ä¸ªè§†å›¾ | 9 | âŒ å¦ | - |

---

## æ€»ç»“

è¿™ä¸¤ä¸ªé—®é¢˜éƒ½æºäº**é…ç½®å‡è®¾ä¸å®é™…æ•°æ®ä¸ä¸€è‡´**ï¼š

1. **é—®é¢˜2**ï¼šç‰¹å¾ç»´åº¦è®¡ç®—åŸºäºé…ç½®ï¼Œä½†å®é™…è¿”å›çš„ç»´åº¦ä¸åŒ
2. **é—®é¢˜2.1**ï¼šå³ä½¿æ›´æ–°äº†ç»´åº¦å±æ€§ï¼ŒMLPç»“æ„ä»ç„¶æ˜¯åˆå§‹åŒ–æ—¶çš„ï¼Œå¯¼è‡´å‰å‘ä¼ æ’­å¤±è´¥

**æ ¹æœ¬åŸå› **ï¼š`num_neighbour_select` çš„è®¾è®¡æ„å›¾æ˜¯é™åˆ¶è§†å›¾æ•°é‡ï¼Œä½†å®é™…å®ç°ä¸­ `sample_within_window` è¿”å›æ‰€æœ‰è§†å›¾çš„ç‰¹å¾ï¼Œæ²¡æœ‰è¿›è¡Œé™åˆ¶ã€‚

**æ¨èä¿®å¤**ï¼š
- **ç«‹å³ä¿®å¤**ï¼šä½¿ç”¨æ–¹æ¡ˆAï¼Œåœ¨reshapeå‰é™åˆ¶è§†å›¾æ•°é‡
- **é•¿æœŸä¼˜åŒ–**ï¼šä½¿ç”¨æ–¹æ¡ˆCï¼Œåœ¨åˆå§‹åŒ–æ—¶ç¡®ä¿é…ç½®ä¸€è‡´æ€§

